<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>CrusDe: plugin_src/crustal_decay/exponential.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1-20091004 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>plugin_src/crustal_decay/exponential.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="crusde__api_8h_source.html">crusde_api.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for exponential.c:</div>
<div class="dynsection">
<div class="center"><img src="exponential_8c__incl.png" border="0" usemap="#plugin__src_2crustal__decay_2exponential_8c_map" alt=""/></div>
<map name="plugin__src_2crustal__decay_2exponential_8c_map" id="plugin__src_2crustal__decay_2exponential_8c">
<area shape="rect" href="crusde__api_8h.html" title="crusde_api.h" alt="" coords="256,80,352,107"/><area shape="rect" href="constants_8h.html" title="constants.h" alt="" coords="159,155,247,181"/><area shape="rect" href="config_8h.html" title="config.h" alt="" coords="271,155,337,181"/></map>
</div>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#aa37ab6a2f004bfa2c956115231072736">get_name</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a5620c12b88f92fa8437f2b92b9cc661a">get_version</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a9cb7fa4e5ce704ea89aa0b19de319df1">get_authors</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="crusde__api_8h.html#a8e337e7fa33f330390bbd59f2cd2b37a">PluginCategory</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a6718e3375be209c3b30dfdf84f7ebc9c">get_category</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#ad42f030a1d29113cb23fad72f54e5220">get_description</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a6b7aad3f14d45970fb736b953048c303">request_plugins</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a92474723fd5c3c7a92d5de73ccc9fdab">register_output_fields</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a13a43e6d814de94978c515cb084873b1">run</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Performs the fast convolution.  <a href="#a13a43e6d814de94978c515cb084873b1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialization of the convolution. Allocation of memory for inputs and outputs.  <a href="#a02fd73d861ef2e4aabb38c0c9ff82947"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a8d8a340c9e92212550682cb42d078ca1">register_parameter</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Register parameters this Kernel claims from the input.  <a href="#a8d8a340c9e92212550682cb42d078ca1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a505317db51364aaf7ed0b947b2f4f6b9">get_value_at</a> (unsigned int <a class="el" href="fast__conv__time__space_8c.html#a8668751464d9f21f49861f2c4c8b211e">t</a>)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a8b21a54e81106e30fec41465f4f581f2">p_tR</a> [100]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#a6709daecdc6ed15d9ee52200d486729d">tR</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="exponential_8c.html#af9650afe4b09491cf2583300c86c81fb">my_id</a> = 0</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Sinusoidal load history that calculates a load height depending on the current time step (t), a period length (p) and the timestep when the load is supposed to be at maximum (<em>d<sub>m</sub></em>):</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ h(t) = \frac{h_m}{2} \left[ 1 + cos( \frac{2\,\pi}{p} (t - d_m) ) \right] \]" src="form_0.png"/>
</p>
<p> with <em>h<sub>m</sub></em> being the maximum load height. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ac8bb3912a3ce86b15842e79d0b421204"></a><!-- doxytag: member="exponential.c::clear" ref="ac8bb3912a3ce86b15842e79d0b421204" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clear </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>freeing mallocs</p>
<p>Frees memory allocated during <a class="el" href="exponential_8c.html#a02fd73d861ef2e4aabb38c0c9ff82947" title="Initialization of the convolution. Allocation of memory for inputs and outputs.">init()</a>. FFTW plans are destroyed. </p>

</div>
</div>
<a class="anchor" id="a9cb7fa4e5ce704ea89aa0b19de319df1"></a><!-- doxytag: member="exponential.c::get_authors" ref="a9cb7fa4e5ce704ea89aa0b19de319df1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* get_authors </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6718e3375be209c3b30dfdf84f7ebc9c"></a><!-- doxytag: member="exponential.c::get_category" ref="a6718e3375be209c3b30dfdf84f7ebc9c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crusde__api_8h.html#a8e337e7fa33f330390bbd59f2cd2b37a">PluginCategory</a> get_category </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>References <a class="el" href="crusde__api_8h_source.html#l00054">CRUSTALDECAY_PLUGIN</a>.</p>

<p>Referenced by <a class="el" href="exponential_8c_source.html#l00061">register_parameter()</a>.</p>

</div>
</div>
<a class="anchor" id="ad42f030a1d29113cb23fad72f54e5220"></a><!-- doxytag: member="exponential.c::get_description" ref="ad42f030a1d29113cb23fad72f54e5220" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* get_description </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa37ab6a2f004bfa2c956115231072736"></a><!-- doxytag: member="exponential.c::get_name" ref="aa37ab6a2f004bfa2c956115231072736" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* get_name </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="alma_8c_source.html#l00097">register_output_fields()</a>, and <a class="el" href="fast__conv_8c_source.html#l00220">run()</a>.</p>

</div>
</div>
<a class="anchor" id="a505317db51364aaf7ed0b947b2f4f6b9"></a><!-- doxytag: member="exponential.c::get_value_at" ref="a505317db51364aaf7ed0b947b2f4f6b9" args="(unsigned int t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double get_value_at </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>t</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>References <a class="el" href="crusde__api_8cpp_source.html#l00384">crusde_get_current_load_component()</a>, <a class="el" href="exponential_8c_source.html#l00036">my_id</a>, <a class="el" href="exponential_8c_source.html#l00033">p_tR</a>, and <a class="el" href="exponential_8c_source.html#l00034">tR</a>.</p>

</div>
</div>
<a class="anchor" id="a5620c12b88f92fa8437f2b92b9cc661a"></a><!-- doxytag: member="exponential.c::get_version" ref="a5620c12b88f92fa8437f2b92b9cc661a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* get_version </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a02fd73d861ef2e4aabb38c0c9ff82947"></a><!-- doxytag: member="exponential.c::init" ref="a02fd73d861ef2e4aabb38c0c9ff82947" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialization of the convolution. Allocation of memory for inputs and outputs. </p>
<p>empty</p>
<p>The field sizes are adjusted according to the needs to avoid wrap around effects in the spectal domain and allow for effective use of DFT (lenght and width are a power of 2). Memory is allocated using fftw_malloc for DFT inputs and outputs (load_in, load_out, green_in, green_out, conv_in, conv_out). Three FFTW plans are created for DFT transform of Green and load arrays and IDFT of the convolution result back to original domain.</p>
<p>initializes local vars</p>
<p>initializes local variables </p>

</div>
</div>
<a class="anchor" id="a92474723fd5c3c7a92d5de73ccc9fdab"></a><!-- doxytag: member="exponential.c::register_output_fields" ref="a92474723fd5c3c7a92d5de73ccc9fdab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void register_output_fields </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>empty </p>

</div>
</div>
<a class="anchor" id="a8d8a340c9e92212550682cb42d078ca1"></a><!-- doxytag: member="exponential.c::register_parameter" ref="a8d8a340c9e92212550682cb42d078ca1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void register_parameter </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Register parameters this Kernel claims from the input. </p>
<p>Register parameters this load function claims from the input.</p>
<p>empty</p>
<p>This plugin calls register_kernel_param() defined in <a class="el" href="crusde__api_8h.html">crusde_api.h</a> to register references to parameters this Kernel will need to operate properly. For command line use the order of registration in this function defines the identification of parameters in the command line string (i.e. './green -KfirstRegistered/secondRegistered/...'). In case an XML is used to configure the experiment, the reference to this parameter will be identified by the string passed as second argument to register_kernel_param().</p>
<p>This function registers the references in the following order:</p>
<p>Thus, the command line parameter string is: <code>-K</code></p>
<dl class="see"><dt><b>See also:</b></dt><dd>register_kernel_param() </dd>
<dd>
<a class="el" href="exponential_8c.html#a8d8a340c9e92212550682cb42d078ca1" title="Register parameters this Kernel claims from the input.">register_parameter()</a> (<a class="el" href="temp__plugin_8c_8tmp.html">temp_plugin.c.tmp</a>) </dd></dl>

<p>References <a class="el" href="crusde__api_8cpp_source.html#l00384">crusde_get_current_load_component()</a>, <a class="el" href="crusde__api_8cpp_source.html#l00135">crusde_register_param_double()</a>, <a class="el" href="exponential_8c_source.html#l00041">get_category()</a>, <a class="el" href="exponential_8c_source.html#l00036">my_id</a>, and <a class="el" href="exponential_8c_source.html#l00033">p_tR</a>.</p>

</div>
</div>
<a class="anchor" id="a6b7aad3f14d45970fb736b953048c303"></a><!-- doxytag: member="exponential.c::request_plugins" ref="a6b7aad3f14d45970fb736b953048c303" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void request_plugins </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>empty</p>
<p>we re-use spatial convolution! </p>

</div>
</div>
<a class="anchor" id="a13a43e6d814de94978c515cb084873b1"></a><!-- doxytag: member="exponential.c::run" ref="a13a43e6d814de94978c515cb084873b1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void run </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Performs the fast convolution. </p>
<p>empty</p>
<p>Requests values for each point in the examined area from Green's function (only once when modeltime == 0) and load function (every timestep). Does the origin shifting necessary for the Green's function values. The Green's function values are requested for each displacement direction the Green's function registered with the CrusDe.</p>
<p>FFTW plan is executed for the load. Then for each Green's function displacement direction the FFTW plan is executed, a complex multiplication of the DFT results performed and then for product the FFTW plan is executed (IDFT). The result of the convolution is extracted from the oversized IDFT result and cropped to the original size of the examined region.</p>
<p>CAN ONLY BE USE FOR ONE LOAD (i.e. multiple loads in one load file), to realize reuse of this operator in fast_conv_time_space - the loads want to have independent load histories!</p>
<p>Requests values for each point in the examined area from Green's function (only once when modeltime == 0) and load function (every timestep). Does the origin shifting necessary for the Green's function values. The Green's function values are requested for each displacement direction the Green's function registered with the CrusDe.</p>
<p>FFTW plan is executed for the load. Then for each Green's function displacement direction the FFTW plan is executed, a complex multiplication of the DFT results performed and then for product the FFTW plan is executed (IDFT). The result of the convolution is extracted from the oversized IDFT result and cropped to the original size of the examined region.</p>
<p>ATTN: result[d][x] still holds the values from the last time run was called. This way adding up the results of multiple jobs is realized!</p>
<p>does the conversion.</p>
<p>does the calculation </p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="af9650afe4b09491cf2583300c86c81fb"></a><!-- doxytag: member="exponential.c::my_id" ref="af9650afe4b09491cf2583300c86c81fb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="sinusoidal__rate_8c.html#af9650afe4b09491cf2583300c86c81fb">my_id</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Referenced by <a class="el" href="exponential_8c_source.html#l00069">get_value_at()</a>, <a class="el" href="irregular__load_8c_source.html#l00178">init()</a>, and <a class="el" href="exponential_8c_source.html#l00061">register_parameter()</a>.</p>

</div>
</div>
<a class="anchor" id="a8b21a54e81106e30fec41465f4f581f2"></a><!-- doxytag: member="exponential.c::p_tR" ref="a8b21a54e81106e30fec41465f4f581f2" args="[100]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* <a class="el" href="exponential__rate_8c.html#a8b21a54e81106e30fec41465f4f581f2">p_tR</a>[100]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>effective relaxation time [yr] </p>

<p>Referenced by <a class="el" href="exponential_8c_source.html#l00069">get_value_at()</a>, and <a class="el" href="exponential_8c_source.html#l00061">register_parameter()</a>.</p>

</div>
</div>
<a class="anchor" id="a6709daecdc6ed15d9ee52200d486729d"></a><!-- doxytag: member="exponential.c::tR" ref="a6709daecdc6ed15d9ee52200d486729d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="exponential__rate_8c.html#a6709daecdc6ed15d9ee52200d486729d">tR</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>effective relaxation time [yr] </p>

<p>Referenced by <a class="el" href="exponential_8c_source.html#l00069">get_value_at()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Mon Feb 15 18:41:28 2010 for CrusDe by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1-20091004 </small></address>
</body>
</html>
